<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Legal AI Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            backdrop-filter: blur(20px);
            animation: slideDown 1s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            margin-bottom: 10px;
        }

        .model-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .model-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            position: relative;
            overflow: hidden;
        }

        .model-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .model-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .chat-container {
    flex: 1;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 25px;
    display: flex;  /* keep it visible */
    flex-direction: column;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0,0,0,0.3);
    animation: fadeInUp 1.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.3);
}



        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .ai-avatar {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            animation: pulse 2s infinite;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .ai-status {
            flex: 1;
        }

        .ai-status h3 {
            margin-bottom: 8px;
            font-size: 1.4rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .online-dot {
            width: 10px;
            height: 10px;
            background: #4caf50;
            border-radius: 50%;
            animation: blink 2s infinite;
            box-shadow: 0 0 10px #4caf50;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .performance-stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .chat-messages {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: linear-gradient(to bottom, #f8f9ff, #ffffff);
            position: relative;
        }

        .message {
            margin-bottom: 25px;
            animation: messageSlide 0.6s ease;
            position: relative;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            display: flex;
            justify-content: flex-end;
        }

        .message.ai {
            display: flex;
            justify-content: flex-start;
        }

        .message-content {
            max-width: 75%;
            padding: 20px 25px;
            border-radius: 25px;
            position: relative;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 8px;
        }

        .message.ai .message-content {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: 2px solid #e3e8ff;
            border-bottom-left-radius: 8px;
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 15px;
            padding: 20px 25px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            max-width: 150px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .typing-dots {
            display: flex;
            gap: 6px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: #667eea;
            border-radius: 50%;
            animation: typingDot 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDot {
            0%, 60%, 100% { transform: scale(1); opacity: 0.3; }
            30% { transform: scale(1.3); opacity: 1; }
        }

        .chat-input {
            padding: 25px;
            background: rgba(255, 255, 255, 0.98);
            border-top: 2px solid #e3e8ff;
        }

        .input-container {
            display: flex;
            gap: 15px;
            align-items: center;
            background: #f8f9ff;
            border-radius: 30px;
            padding: 15px 25px;
            border: 2px solid #e3e8ff;
            transition: all 0.4s ease;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        }

        .input-container:focus-within {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
        }

        #user-input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            font-size: 16px;
            padding: 10px 0;
            color: #333;
        }

        #user-input::placeholder {
            color: #999;
        }

        .send-btn {
            width: 50px;
            height: 50px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        .quick-questions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .quick-question {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .quick-question:hover {
            background: #667eea;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .welcome-message {
            text-align: center;
            color: #666;
            padding: 50px 20px;
        }

        .welcome-message h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 28px;
        }

        .legal-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .section-badge {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .section-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s ease;
        }

        .section-badge:hover::before {
            left: 100%;
        }

        .section-badge:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .response-metadata {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(102, 126, 234, 0.05);
            border-left: 4px solid #667eea;
            font-size: 13px;
            border-radius: 0 8px 8px 0;
            animation: fadeInUp 0.8s ease;
        }

        .confidence-high { border-left-color: #4caf50; }
        .confidence-medium { border-left-color: #ff9800; }
        .confidence-low { border-left-color: #f44336; }

        .feature-highlight {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            color: #2d3436;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #e17055;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .processing-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(3px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .processing-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer-info {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: rgba(255,255,255,0.95);
            padding: 12px 18px;
            border-radius: 25px;
            font-size: 12px;
            color: #666;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2.2rem; }
            .message-content { max-width: 90%; }
            .legal-sections { grid-template-columns: 1fr; }
            .model-selector { justify-content: center; }
            .performance-stats { grid-template-columns: repeat(2, 1fr); }
        }

        /* Enhanced scrollbar */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Interactive Legal AI Assistant</h1>
            <p>Advanced AI-Powered Legal Compliance Expert</p>
            <p style="font-size: 1rem; opacity: 0.8;">EPF Act 1952 • TDS/TCS Provisions • Companies Act 2013</p>
            
            <div class="model-selector">
                <button class="model-btn active" onclick="switchModel('neural-network')" data-model="neural-network">
                    Neural Network
                </button>
                <button class="model-btn" onclick="switchModel('transformer')" data-model="transformer">
                    Transformer
                </button>
                <button class="model-btn" onclick="switchModel('decision-tree')" data-model="decision-tree">
                    Decision Tree
                </button>
                <button class="model-btn" onclick="switchModel('random-forest')" data-model="random-forest">
                    Random Forest
                </button>
                <button class="model-btn" onclick="switchModel('expert-system')" data-model="expert-system">
                    Expert System
                </button>
                <button class="model-btn" onclick="switchModel('hybrid')" data-model="hybrid">
                    Hybrid AI
                </button>
            </div>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <div class="ai-avatar">🤖</div>
                <div class="ai-status">
                    <h3>Legal AI Assistant</h3>
                    <div class="status-indicator">
                        <span class="online-dot"></span>
                        <span id="current-status">Neural Network Model Active</span>
                    </div>
                </div>
            </div>

            <div class="performance-stats">
                <div class="stat-item">
                    <span class="stat-value" id="queries-processed">0</span>
                    <span class="stat-label">Queries Processed</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="avg-response-time">0.0s</span>
                    <span class="stat-label">Avg Response Time</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="confidence-score">95%</span>
                    <span class="stat-label">Model Confidence</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="active-model">Neural</span>
                    <span class="stat-label">Active Model</span>
                </div>
            </div>

            <div class="chat-messages" id="chat-messages">
                <div class="processing-overlay" id="processing-overlay">
                    <div class="loading-spinner"></div>
                </div>

                <div class="welcome-message" id="welcome-message">
                    <h3>Welcome! How can I help you today?</h3>
                    <p>I'm an advanced AI trained on comprehensive legal documents including EPF Act 1952, Income Tax Act provisions for TDS/TCS, and Companies Act 2013. Ask me anything about legal compliance!</p>
                    
                    <div class="legal-sections">
                        <div class="section-badge" onclick="askQuickQuestion('What is the current EPF contribution rate for employers and employees?')">
                            📋 EPF Act 1952
                            <br><small>Contribution Rates & Compliance</small>
                        </div>
                        <div class="section-badge" onclick="askQuickQuestion('What are the TDS rates for different types of income in FY 2024-25?')">
                            💰 TDS/TCS Rules
                            <br><small>Tax Deduction & Collection</small>
                        </div>
                        <div class="section-badge" onclick="askQuickQuestion('How many board meetings are required under Companies Act 2013?')">
                            🏢 Companies Act 2013
                            <br><small>Corporate Governance</small>
                        </div>
                    </div>

                    <div class="feature-highlight">
                        <strong>🚀 Advanced AI Features:</strong> Multi-model analysis, real-time legal interpretation, contextual understanding, and comprehensive compliance guidance with citation tracking
                    </div>
                </div>
                
                <div class="typing-indicator" id="typing-indicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span>AI is analyzing...</span>
                </div>
            </div>

            <div class="chat-input">
                <div class="quick-questions">
                    <div class="quick-question" onclick="askQuickQuestion('What is EPF contribution rate for 2024-25?')">EPF Rates</div>
                    <div class="quick-question" onclick="askQuickQuestion('TDS due dates for this financial year')">TDS Deadlines</div>
                    <div class="quick-question" onclick="askQuickQuestion('Minimum board meetings required annually')">Board Meetings</div>
                    <div class="quick-question" onclick="askQuickQuestion('EPF penalty for late payment')">EPF Penalties</div>
                    <div class="quick-question" onclick="askQuickQuestion('TCS rates on foreign remittance')">TCS on Forex</div>
                    <div class="quick-question" onclick="askQuickQuestion('Companies Act CSR compliance')">CSR Rules</div>
                </div>
                
                <div class="input-container">
                    <input type="text" id="user-input" placeholder="Ask me about EPF, TDS/TCS, or Companies Act compliance..." maxlength="1000">
                    <button class="send-btn" id="send-btn" onclick="sendMessage()">
                        <span>🚀</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="footer-info">
        <strong>Legal AI v2.0</strong> | Interactive & Intelligent
    </div>

    <script>
        // Advanced Legal Knowledge Base with Real Legal Provisions
        const comprehensiveLegalKB = {
            epf: {
                contribution_rates: {
                    content: "Under Section 6 of EPF Act 1952, the contribution rates are:\n\n• **Employee Contribution**: 12% of basic wages + dearness allowance\n• **Employer Contribution**: 12% of basic wages + dearness allowance\n• **For establishments with <20 employees**: Rate can be 10% (voluntary)\n\n**Calculation Base**: Basic wages + dearness allowance + retaining allowance (if any)\n\n**Important**: Cash value of food concession is also included in wages for contribution calculation.\n\n**Recent Update**: The rates have remained consistent, but wage ceiling for applicability is ₹15,000 per month.",
                    section: "Section 6, EPF Act 1952",
                    confidence: 95,
                    lastUpdated: "2024"
                },
                applicability: {
                    content: "**EPF Act 1952 Applicability**:\n\n• Establishments with **20 or more employees** in scheduled industries\n• Can be extended to establishments with **<20 employees voluntarily**\n• Applies to employees earning up to **₹15,000 per month**\n\n**Scheduled Industries Include**:\n• Manufacturing industries\n• Mining operations\n• Construction industry\n• Hotels and restaurants\n• Newspaper establishments\n• Cinemas/theaters\n• Road transport\n• And many more specified in Schedule\n\n**Coverage**: All employees except those specifically excluded under the Act.",
                    section: "Section 1(3), EPF Act 1952 & Schedule",
                    confidence: 98,
                    lastUpdated: "2024"
                },
                penalties: {
                    content: "**EPF Penalties under Section 14**:\n\n**Criminal Penalties**:\n• **Non-payment of contributions**: Imprisonment up to **3 years** + fine up to **₹10,000**\n• **Other defaults**: Imprisonment up to **1 year** + fine up to **₹5,000**\n• **Repeat offenses**: Enhanced punishment up to **5 years** + fine up to **₹25,000**\n\n**Administrative Penalties**:\n• **Damage assessment**: 12% per annum interest on delayed contributions\n• **Penal damages**: Up to 25% of the arrears under Section 14B\n\n**Recent Amendments**: Supreme Court has clarified that penal damages under 14B require show cause notice.",
                    section: "Section 14 & 14B, EPF Act 1952",
                    confidence: 96,
                    lastUpdated: "2024"
                },
                withdrawal: {
                    content: "**EPF Withdrawal Rules**:\n\n**Full Withdrawal Conditions**:\n• **2 months unemployment** after leaving job\n• **Attaining age 58** (retirement)\n• **Permanent emigration** from India\n• **Total incapacitation** from work\n\n**Partial Withdrawal** (after 7 years service):\n• Medical treatment (employee/family)\n• Education (self/children)\n• Marriage (employee/children)\n• House construction/purchase\n• Household needs during unemployment\n\n**Tax Implications**:\n• **5 years continuous service**: Tax-free withdrawal\n• **Less than 5 years**: Taxable as per Income Tax Act\n\n**Process**: Online through EPF portal with UAN and Aadhaar linking mandatory.",
                    section: "EPF Scheme Para 68-74",
                    confidence: 94,
                    lastUpdated: "2024"
                }
            },
            tds: {
                salary_rates: {
                    content: "**TDS on Salary - FY 2024-25** (Section 192):\n\n**New Tax Regime** (Default):\n• Up to ₹3,00,000: **Nil**\n• ₹3,00,001 to ₹6,00,000: **5%**\n• ₹6,00,001 to ₹9,00,000: **10%**\n• ₹9,00,001 to ₹12,00,000: **15%**\n• ₹12,00,001 to ₹15,00,000: **20%**\n• Above ₹15,00,000: **30%**\n\n**Old Tax Regime** (if opted):\n• Up to ₹2,50,000: **Nil** (₹3,00,000 for senior citizens)\n• ₹2,50,001 to ₹5,00,000: **5%**\n• ₹5,00,001 to ₹10,00,000: **20%**\n• Above ₹10,00,000: **30%**\n\n**Additional**: Health & Education Cess @4% on total tax\n**Surcharge**: Applicable on income above ₹50 lakhs",
                    section: "Section 192, Income Tax Act 1961",
                    confidence: 99,
                    lastUpdated: "2024"
                },
                due_dates: {
                    content: "**TDS Due Dates for FY 2024-25**:\n\n**Government Deductors**:\n• April-June quarter: **30th July 2024**\n• July-September quarter: **30th October 2024**\n• October-December quarter: **30th January 2025**\n• January-March quarter: **30th April 2025**\n\n**Non-Government Deductors**:\n• Monthly: **7th of next month**\n• Example: April TDS due by **7th May 2024**\n\n**Late Payment Consequences**:\n• **Interest**: 1.5% per month from due date\n• **Penalty**: ₹200 per day under Section 234E\n• **Prosecution**: Possible under Section 276B\n\n**E-Payment**: Mandatory for TDS above ₹10,000\n**TDS Return Filing**: Quarterly within specified dates",
                    section: "Section 200, Income Tax Act 1961",
                    confidence: 98,
                    lastUpdated: "2024"
                },
                professional_fees: {
                    content: "**TDS on Professional Fees** (Section 194J):\n\n**Rate**: **10%** on payments exceeding **₹30,000** per year\n\n**Covered Services**:\n• Professional services (CA, Lawyer, Doctor, Engineer)\n• Technical services\n• Managerial services\n• Consultancy services\n• Royalty payments\n• Non-compete fees\n\n**Threshold**: ₹30,000 per payee per year\n\n**Exemptions**:\n• Payments to individuals/HUF if:\n  - Business turnover < ₹1 crore (44AD)\n  - Professional receipts < ₹50 lakhs (44ADA)\n\n**Rate for Non-PAN**: **20%**\n**TDS Certificate**: Form 16A to be issued\n**Quarterly Return**: Form 26Q",
                    section: "Section 194J, Income Tax Act 1961",
                    confidence: 97,
                    lastUpdated: "2024"
                },
                tcs_foreign: {
                    content: "**TCS on Foreign Remittance** (Section 206C(1G)):\n\n**LRS (Liberalized Remittance Scheme)**:\n• **Rate**: 5% on amount exceeding **₹7 lakhs per year**\n• **Annual Limit**: USD 250,000 per person\n\n**Education Abroad**:\n• **Rate**: 0.5% (concessional)\n• **Condition**: Loan from financial institution OR payment directly to educational institution\n\n**Medical Treatment**:\n• **Rate**: 0.5% (concessional)\n• **Condition**: Payment for medical treatment abroad\n\n**TCS Threshold**: ₹7,00,000 per financial year\n**Credit**: TCS collected can be claimed as advance tax\n**Form**: 27D for TCS certificate\n**Return**: Form 27EQ quarterly",
                    section: "Section 206C(1G), Income Tax Act 1961",
                    confidence: 96,
                    lastUpdated: "2024"
                }
            },
            companies: {
                board_meetings: {
                    content: "**Board Meeting Requirements** (Section 173):\n\n**Minimum Meetings**: **4 per year** (at least one per quarter)\n**Maximum Gap**: **120 days** between consecutive meetings\n\n**Notice Requirements**:\n• **Minimum**: 7 days advance notice\n• **Shorter Notice**: Possible if consent of all directors\n• **Mode**: Can be physical, video conferencing, or hybrid\n\n**Quorum**:\n• **General Rule**: 1/3rd of total strength OR 2 directors (whichever is higher)\n• **Minimum**: Cannot be less than 2 directors\n• **Independent Directors**: Separate meeting at least once a year\n\n**Documentation**:\n• Minutes to be prepared within 30 days\n• Signed by Chairman of meeting or next meeting\n• Register to be maintained at registered office",
                    section: "Section 173, Companies Act 2013",
                    confidence: 98,
                    lastUpdated: "2024"
                },
                annual_compliance: {
                    content: "**Annual Compliance Timeline**:\n\n**Annual General Meeting (AGM)**:\n• **Deadline**: Within 6 months of financial year end\n• **Gap**: Not more than 15 months between consecutive AGMs\n• **First AGM**: Within 18 months of incorporation\n\n**Annual Return (MGT-7)**:\n• **Deadline**: Within 60 days of AGM\n• **Late Filing Fee**: ₹100/day (company) + ₹100/day (officers)\n\n**Financial Statements (AOC-4)**:\n• **Deadline**: Within 30 days of AGM\n• **Content**: Balance Sheet, P&L, Cash Flow, Notes\n\n**Board Report**:\n• Annexed to financial statements\n• Must include various mandatory disclosures",
                    section: "Sections 96, 92, 137 - Companies Act 2013",
                    confidence: 97,
                    lastUpdated: "2024"
                },
                csr_compliance: {
                    content: "**Corporate Social Responsibility** (Section 135):\n\n**Applicability Criteria** (Any one):\n• Net worth ≥ **₹500 crores**\n• Turnover ≥ **₹1000 crores** \n• Net profit ≥ **₹5 crores**\n\n**CSR Spending**:\n• **Minimum**: 2% of average net profit of preceding 3 years\n• **Unspent Amount**: To be transferred to specified funds or ongoing projects\n\n**CSR Committee**:\n• **Composition**: Minimum 3 directors\n• **Independent Director**: At least 1 (if applicable)\n• **Responsibilities**: Policy formulation, monitoring, reporting\n\n**CSR Activities**: As per Schedule VII of the Act\n**Annual Report**: Mandatory disclosure of CSR activities and spending",
                    section: "Section 135 & Schedule VII, Companies Act 2013",
                    confidence: 96,
                    lastUpdated: "2024"
                }
            }
        };

        // Advanced AI Response Engine
        class InteractiveLegalAI {
            constructor() {
                this.currentModel = 'neural-network';
                this.conversationHistory = [];
                this.queryCount = 0;
                this.totalResponseTime = 0;
                this.isProcessing = false;
                this.modelCapabilities = {
                    'neural-network': { accuracy: 95, speed: 85, complexity: 90 },
                    'transformer': { accuracy: 98, speed: 75, complexity: 95 },
                    'decision-tree': { accuracy: 88, speed: 95, complexity: 70 },
                    'random-forest': { accuracy: 92, speed: 80, complexity: 85 },
                    'expert-system': { accuracy: 90, speed: 90, complexity: 95 },
                    'hybrid': { accuracy: 97, speed: 78, complexity: 98 }
                };
            }

            async processQuery(userQuery) {
                if (this.isProcessing) {
                    return {
                        content: "Please wait while I process your previous query. I'm currently analyzing legal provisions to provide you with accurate information.",
                        confidence: 'High',
                        model: this.getModelDisplayName(this.currentModel),
                        processingTime: '0.1s',
                        citations: []
                    };
                }

                this.isProcessing = true;
                const startTime = performance.now();

                try {
                    // Enhanced query analysis
                    const queryAnalysis = await this.analyzeQuery(userQuery);
                    const response = await this.generateIntelligentResponse(queryAnalysis);
                    
                    const processingTime = ((performance.now() - startTime) / 1000).toFixed(2);
                    this.updateStats(processingTime);

                    return {
                        content: response.content,
                        confidence: response.confidence,
                        model: this.getModelDisplayName(this.currentModel),
                        processingTime: processingTime + 's',
                        citations: response.citations
                    };
                } catch (error) {
                    console.error('AI Processing Error:', error);
                    return {
                        content: "I apologize for the technical difficulty. Please rephrase your question, and I'll provide you with comprehensive legal guidance.",
                        confidence: 'Medium',
                        model: this.getModelDisplayName(this.currentModel),
                        processingTime: '0.5s',
                        citations: []
                    };
                } finally {
                    this.isProcessing = false;
                }
            }

            async analyzeQuery(query) {
                // Simulate advanced NLP processing
                await this.simulateProcessingDelay();
                
                const lowerQuery = query.toLowerCase();
                return {
                    category: this.identifyLegalDomain(lowerQuery),
                    intent: this.extractUserIntent(lowerQuery),
                    entities: this.extractLegalEntities(lowerQuery),
                    complexity: this.assessQueryComplexity(query),
                    context: this.buildContext(),
                    urgency: this.detectUrgency(lowerQuery)
                };
            }

            identifyLegalDomain(query) {
                const domainKeywords = {
                    epf: ['epf', 'provident fund', 'pf contribution', 'employee provident', 'epfo', 'pf withdrawal'],
                    tds: ['tds', 'tcs', 'tax deducted', 'tax collected', 'income tax', 'withholding tax', 'advance tax'],
                    companies: ['company', 'companies act', 'board meeting', 'director', 'agm', 'annual general meeting', 'csr', 'corporate']
                };

                for (const [domain, keywords] of Object.entries(domainKeywords)) {
                    if (keywords.some(keyword => query.includes(keyword))) {
                        return domain;
                    }
                }
                return 'general';
            }

            extractUserIntent(query) {
                const intentPatterns = {
                    definition: /what is|define|meaning of|explain/i,
                    procedure: /how to|process|steps|procedure/i,
                    penalty: /penalty|fine|punishment|consequences/i,
                    rates: /rate|percentage|amount|how much/i,
                    timeline: /when|due date|deadline|timeline/i,
                    compliance: /compliance|requirement|mandatory|must/i,
                    calculation: /calculate|computation|formula/i
                };

                for (const [intent, pattern] of Object.entries(intentPatterns)) {
                    if (pattern.test(query)) return intent;
                }
                return 'general_inquiry';
            }

            extractLegalEntities(query) {
                const entities = [];
                
                // Extract sections
                const sectionMatches = query.match(/section\s+\d+[a-z]*\b/gi);
                if (sectionMatches) {
                    entities.push(...sectionMatches.map(s => ({ type: 'section', value: s })));
                }

                // Extract amounts
                const amountMatches = query.match(/₹\s*[\d,]+|rs\.?\s*[\d,]+|\d+\s*(?:crore|lakh|thousand)/gi);
                if (amountMatches) {
                    entities.push(...amountMatches.map(a => ({ type: 'amount', value: a })));
                }

                // Extract percentages
                const percentageMatches = query.match(/\d+(?:\.\d+)?%/g);
                if (percentageMatches) {
                    entities.push(...percentageMatches.map(p => ({ type: 'percentage', value: p })));
                }

                return entities;
            }

            assessQueryComplexity(query) {
                const factors = {
                    length: query.split(' ').length,
                    legalTerms: (query.match(/section|clause|amendment|provision|sub-section|schedule/gi) || []).length,
                    multipleQuestions: (query.match(/\?/g) || []).length,
                    technicalTerms: (query.match(/compliance|penalty|applicability|calculation/gi) || []).length
                };

                const complexityScore = factors.length * 0.3 + 
                                     factors.legalTerms * 2 + 
                                     factors.multipleQuestions * 1.5 + 
                                     factors.technicalTerms * 1.2;

                if (complexityScore > 15) return 'high';
                if (complexityScore > 8) return 'medium';
                return 'low';
            }

            buildContext() {
                const recentQueries = this.conversationHistory.slice(-3);
                return recentQueries.map(q => q.query).join(' ');
            }

            detectUrgency(query) {
                const urgentKeywords = ['urgent', 'immediate', 'asap', 'quickly', 'emergency', 'deadline today'];
                return urgentKeywords.some(keyword => query.includes(keyword)) ? 'high' : 'normal';
            }

            async generateIntelligentResponse(analysis) {
                await this.simulateModelProcessing();

                const matches = this.findBestKnowledgeMatches(analysis);
                
                if (matches.length === 0) {
                    return this.generateContextualFallback(analysis);
                }

                const primaryMatch = matches[0];
                let response = this.formatLegalResponse(primaryMatch, analysis);
                
                // Apply model-specific processing
                response = this.applyModelEnhancements(response, analysis);

                return {
                    content: response,
                    confidence: this.calculateConfidence(primaryMatch.score, analysis.complexity),
                    citations: [primaryMatch.data.section]
                };
            }

            findBestKnowledgeMatches(analysis) {
                const categoryKB = comprehensiveLegalKB[analysis.category] || {};
                const matches = [];

                Object.keys(categoryKB).forEach(topic => {
                    const data = categoryKB[topic];
                    const score = this.calculateRelevanceScore(analysis, topic, data);
                    
                    if (score > 0.3) {
                        matches.push({ topic, score, data });
                    }
                });

                return matches.sort((a, b) => b.score - a.score);
            }

            calculateRelevanceScore(analysis, topic, data) {
                let score = 0;
                const queryWords = (analysis.context + ' ' + Object.values(analysis.entities).join(' ')).toLowerCase().split(' ');
                const contentWords = (data.content + ' ' + topic.replace(/_/g, ' ')).toLowerCase().split(' ');

                queryWords.forEach(word => {
                    if (word.length > 3) {
                        if (contentWords.includes(word)) {
                            score += 0.15;
                        }
                        if (topic.replace(/_/g, ' ').toLowerCase().includes(word)) {
                            score += 0.25;
                        }
                    }
                });

                // Intent matching bonus
                if (analysis.intent === 'rates' && topic.includes('rate')) score += 0.3;
                if (analysis.intent === 'penalty' && topic.includes('penalties')) score += 0.3;
                if (analysis.intent === 'procedure' && data.content.includes('process')) score += 0.2;

                return Math.min(score, 1);
            }

            formatLegalResponse(match, analysis) {
                let response = match.data.content;

                // Add contextual enhancements based on intent
                if (analysis.intent === 'penalty' && !response.includes('Penalty')) {
                    response += "\n\n⚠️ **Important**: Non-compliance with these provisions may result in penalties, interest, and legal consequences. Consult a legal expert for specific cases.";
                }

                if (analysis.intent === 'timeline' && !response.includes('deadline')) {
                    response += "\n\n📅 **Note**: Ensure timely compliance with all deadlines to avoid penalties and legal complications.";
                }

                if (analysis.urgency === 'high') {
                    response = "🚨 **Priority Response** - " + response;
                }

                return response;
            }

            applyModelEnhancements(response, analysis) {
                const modelType = this.currentModel;
                
                switch (modelType) {
                    case 'transformer':
                        return this.enhanceWithTransformerInsights(response, analysis);
                    case 'expert-system':
                        return this.addExpertSystemRecommendations(response, analysis);
                    case 'hybrid':
                        return this.applyHybridProcessing(response, analysis);
                    default:
                        return response;
                }
            }

            enhanceWithTransformerInsights(response, analysis) {
                return response + "\n\n🔍 **AI Analysis**: This response was generated using advanced transformer architecture for enhanced contextual understanding and comprehensive legal interpretation.";
            }

            addExpertSystemRecommendations(response, analysis) {
                return response + "\n\n💡 **Expert Recommendation**: Based on rule-based analysis of legal provisions, ensure you cross-reference with latest amendments and consult qualified professionals for implementation.";
            }

            applyHybridProcessing(response, analysis) {
                return response + "\n\n🧠 **Hybrid AI Insight**: This response combines multiple AI approaches for maximum accuracy and practical applicability in real-world legal scenarios.";
            }

            calculateConfidence(score, complexity) {
                let confidence = score * 100;
                
                // Adjust for complexity
                if (complexity === 'high') confidence -= 10;
                else if (complexity === 'low') confidence += 5;

                // Model-specific adjustments
                const modelAccuracy = this.modelCapabilities[this.currentModel].accuracy;
                confidence = (confidence * modelAccuracy) / 100;

                if (confidence >= 90) return 'High';
                if (confidence >= 70) return 'Medium';
                return 'Low';
            }

            generateContextualFallback(analysis) {
                const fallbacks = {
                    epf: "I can help you with EPF Act 1952 related queries. Please specify what you'd like to know about:\n\n• Contribution rates and calculations\n• Applicability and coverage\n• Withdrawal procedures\n• Penalties and compliance\n• Recent amendments and updates\n\nCould you rephrase your question with more specific details?",
                    tds: "I can assist with TDS/TCS provisions under Income Tax Act. Please clarify what specific information you need about:\n\n• TDS rates for different income types\n• Due dates and compliance requirements\n• TCS on various transactions\n• Penalty provisions\n• Recent changes and updates\n\nPlease provide more context for accurate guidance.",
                    companies: "I can help with Companies Act 2013 compliance. Please specify which area you need information about:\n\n• Board meeting requirements\n• Annual compliance and filings\n• CSR obligations\n• Director duties and liabilities\n• Penalty provisions\n\nKindly rephrase with specific details for comprehensive assistance."
                };

                return {
                    content: fallbacks[analysis.category] || "I specialize in EPF Act 1952, TDS/TCS provisions, and Companies Act 2013. Please specify which area your question relates to and provide more details for accurate legal guidance.",
                    confidence: 'Medium',
                    citations: []
                };
            }

            updateStats(processingTime) {
                this.queryCount++;
                this.totalResponseTime += parseFloat(processingTime);
                
                // Update UI stats
                document.getElementById('queries-processed').textContent = this.queryCount;
                document.getElementById('avg-response-time').textContent = 
                    (this.totalResponseTime / this.queryCount).toFixed(1) + 's';
                document.getElementById('confidence-score').textContent = 
                    this.modelCapabilities[this.currentModel].accuracy + '%';
            }

            switchModel(modelName) {
                this.currentModel = modelName;
                document.getElementById('active-model').textContent = 
                    this.getModelDisplayName(modelName).split(' ')[0];
                document.getElementById('current-status').textContent = 
                    this.getModelDisplayName(modelName) + ' Active';
            }

            getModelDisplayName(modelName) {
                const names = {
                    'neural-network': 'Neural Network Model',
                    'transformer': 'Transformer Model',
                    'decision-tree': 'Decision Tree Model',
                    'random-forest': 'Random Forest Model',
                    'expert-system': 'Expert System Model',
                    'hybrid': 'Hybrid AI Model'
                };
                return names[modelName] || 'AI Model';
            }

            async simulateProcessingDelay() {
                const baseDelay = this.modelCapabilities[this.currentModel].speed;
                const delay = Math.random() * (150 - baseDelay) + 300;
                await new Promise(resolve => setTimeout(resolve, delay));
            }

            async simulateModelProcessing() {
                const processingTime = Math.random() * 800 + 400;
                await new Promise(resolve => setTimeout(resolve, processingTime));
            }
        }

        // Initialize Enhanced AI System
        const legalAI = new InteractiveLegalAI();
        let messageCount = 0;
        let isProcessing = false;

        function addMessage(content, isUser = false, metadata = null) {
            const messagesContainer = document.getElementById('chat-messages');
            const welcomeMessage = document.getElementById('welcome-message');
            
            if (welcomeMessage && welcomeMessage.style.display !== 'none') {
                welcomeMessage.style.display = 'none';
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (isUser) {
                contentDiv.textContent = content;
            } else {
                // Enhanced formatting for AI responses
                let formattedContent = content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                formattedContent = formattedContent.replace(/• /g, '<br>• ');
                formattedContent = formattedContent.replace(/\n\n/g, '</p><p>');
                formattedContent = '<p>' + formattedContent + '</p>';
                
                contentDiv.innerHTML = formattedContent;
                
                // Add enhanced metadata
                if (metadata && metadata.citations && metadata.citations.length > 0) {
                    const metaDiv = document.createElement('div');
                    metaDiv.className = `response-metadata confidence-${metadata.confidence.toLowerCase()}`;
                    metaDiv.innerHTML = `
                        <strong>📚 Legal Reference:</strong> ${metadata.citations.join(', ')}<br>
                        <strong>🤖 Model:</strong> ${metadata.model} | 
                        <strong>📊 Confidence:</strong> ${metadata.confidence} | 
                        <strong>⏱️ Processing:</strong> ${metadata.processingTime}
                    `;
                    contentDiv.appendChild(metaDiv);
                }
            }
            
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            document.getElementById('typing-indicator').style.display = 'flex';
            const messagesContainer = document.getElementById('chat-messages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            document.getElementById('typing-indicator').style.display = 'none';
        }

        function showProcessingOverlay() {
            document.getElementById('processing-overlay').classList.add('active');
        }

        function hideProcessingOverlay() {
            document.getElementById('processing-overlay').classList.remove('active');
        }

        async function sendMessage() {
            if (isProcessing) return;
            
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            isProcessing = true;
            input.disabled = true;
            
            addMessage(message, true);
            input.value = '';
            
            showTypingIndicator();
            showProcessingOverlay();
            
            try {
                const response = await legalAI.processQuery(message);
                
                hideTypingIndicator();
                hideProcessingOverlay();
                addMessage(response.content, false, response);
                
            } catch (error) {
                hideTypingIndicator();
                hideProcessingOverlay();
                addMessage("I encountered a technical issue while processing your query. Please try rephrasing your question, and I'll provide comprehensive legal guidance.", false);
                console.error('Response Error:', error);
            } finally {
                isProcessing = false;
                input.disabled = false;
                input.focus();
            }
        }

        function switchModel(modelName) {
            // Update active button
            document.querySelectorAll('.model-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.model === modelName) {
                    btn.classList.add('active');
                }
            });
            
            legalAI.switchModel(modelName);
        }

        function askQuickQuestion(question) {
            if (isProcessing) return;
            document.getElementById('user-input').value = question;
            sendMessage();
        }

        // Enhanced Event Listeners
        document.getElementById('user-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey && !isProcessing) {
                e.preventDefault();
                sendMessage();
            }
        });

        document.getElementById('send-btn').addEventListener('click', sendMessage);

        // Initialize system on load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Enhanced Legal AI System Initialized');
            
            // Simulate system readiness
            setTimeout(() => {
                document.getElementById('current-status').textContent = 'Neural Network Model Ready';
            }, 1000);
        });

        // Error handling and recovery
        window.addEventListener('error', function(e) {
            console.error('System Error:', e.error);
            if (isProcessing) {
                hideTypingIndicator();
                hideProcessingOverlay();
                addMessage("System recovered from error. Please try your query again.", false);
                isProcessing = false;
                document.getElementById('user-input').disabled = false;
            }
        });
    </script>
</body>
</html>